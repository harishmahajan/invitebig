function unparam(e){var t={};if(e&&e.length>0){var n=e.split("&");for(var r=0;r<n.length;r++){var i=n[r].split("=");t[i[0]]=decodeURIComponent(i[1])}}return t}function ExtractUrlFilter(){var e={},t=window.location.href.split("/"),n=-100;for(var r=0;r<t.length;r++)t[r]=="venues"&&(n=r),t[r].indexOf("?")<0&&(r-n==1&&(e.city=t[r]),r-n==2&&(e.venueType=t[r]));var i=window.location.href.indexOf("?");if(i>0){var s=window.location.href.substr(i+1,window.location.href.length-(i+1)),o=s.split("&");for(var r=0;r<o.length;r++){var u=o[r].split("=");u[0]=="types"?e[u[0]]=$.parseJSON(decodeURIComponent(u[1])):e[u[0]]=decodeURIComponent(u[1])}}return e}function LoadSearchVenues(){var e={method:"fGetSearchTypes"};Post(e).then(function(e){for(var t=0;t<e.result.length;t++)$("#bookFilterType").append($("<option></option>",{value:e.result[t],text:e.result[t]}));var n=ExtractUrlFilter(),r=window.location.href.indexOf("/type/");if(r>0){var i=window.location.href.indexOf("/",r+6);i<r&&(i=window.location.href.length),n.typeFilter=window.location.href.substr(r+6,i-(r+6))}console.log("filter",n),$("#bookFilterType option:selected").prop("selected",!1),n.size&&$("#bookFilterPeople option[value="+n.size+"]").attr("selected","selected");if(n.types&&n.types.length>0)for(var t=0;t<n.types.length;t++)n["types"][t]!=null&&$("#bookFilterType option[value='"+String(n.types[t])+"']").prop("selected",!0);n.typeFilter&&$("#bookFilterType option").each(function(){$(this).val().replace(" ","-").toLowerCase()==n["typeFilter"]&&($("#bookFilterType option[value='"+$(this).attr("value")+"']").prop("selected",!0),n.types=[],n.types[0]=$(this).attr("value"))}),typeof $("#bookFilterType")[0].sumo!="undefined"?$("#bookFilterType")[0].sumo.reload():$("#bookFilterType").SumoSelect(),typeof $("#bookFilterPeople")[0].sumo!="undefined"?$("#bookFilterPeople")[0].sumo.reload():$("#bookFilterPeople").SumoSelect(),SearchVenues(n)})}function SearchVenues(e){e.lat=null,e.lng=null,typeof navigator!="undefined"&&navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){e.lat=t.coords.latitude,e.lng=t.coords.longitude});var t={method:"fSearchVenues",filter:e};Post(t).then(function(e){if(e["result"]=="success"){console.log("search results",e.data);var t=e.data;$("#venueSearchResults").empty();if(t&&t.length>0){var n="<div class='row searchVenuesRow'>";for(var r=0;r<t.length;r++){var i=t[r].description;i.length>150&&(i=i.substring(0,150)+"...");var s=9999999,o=0;for(var u=0;u<t[r].resources.length;u++){var a=t[r].resources[u];if(parseFloat(a.min)>parseFloat(a.max)){var f=a.min;a.min=a.max,a.max=f}parseFloat(a.rate)<parseFloat(a.min)&&(a.min=a.rate),parseFloat(a.rate)>parseFloat(a.max)&&(a.max=a.rate),parseFloat(a.min)<s&&(s=parseFloat(a.min)),parseFloat(a.max)>o&&(o=parseFloat(a.max))}if(s>o){var f=s;s=o,o=f}var l=("all/"+t[r].type).toLowerCase().replace(/ /g,"-"),c=(t[r].city+"-"+t[r].state+"/all").toLowerCase().replace(/ /g,"-"),h=(t[r].city+"-"+t[r].state).replace(/\-/g," ").replace(/\s([^\s]*)$/,", $1").capitalize();h=h.substring(0,h.length-1)+h.charAt(h.length-1).toUpperCase();var p="<table class='table table-striped table-condensed'><tbody><tr><td><b>Venue Type</b></td><td><a data-partial=true href='/venues/"+l+"'>"+t[r].type+"</a></td></tr>"+"<tr><td><b>Location</b></td><td><a data-partial=true href='/venues/"+c+"'>"+h+"</td></tr>"+"<tr><td><b>Spaces Available</b></td><td><a data-partial=true href='/reserve/book-an-event-at-"+t[r].url+"'>"+t[r].resources[0].count+" matching search</a></td></tr>"+"<tr><td><b>Pricing</b></td><td>"+FormatDollars(s,t[r].currency)+"/hr - "+FormatDollars(o,t[r].currency)+"/hr</td></tr>"+"</tbody></table>",d=$("<img src='"+SanitizeAttr(t[r].photo)+"'/>");d.attr("alt",t[r].name),n+="<div class='panel col-md-4 venueSearchResult'><div class='panel-body' data-url='"+SanitizeAttr(t[r].url)+"'>"+"<button class='jumpToMap no-display-mob btn btn-sm btn-default' data-target='"+SanitizeAttr(t[r].url)+"'><img src='https://mts.googleapis.com/vt/icon/name=icons/spotlight/spotlight-poi.png&scale=1'/></button>"+"<button class='searchBookNow btn btn-sm btn-default' data-target='"+SanitizeAttr(t[r].url)+"'><i class='fa fa-calendar fa-2'></i></button>"+"<h2><a data-partial=true href='/venue/"+t[r].url+"'>"+(t[r].name.length>39?t[r].name.substring(0,39)+"...":t[r].name)+"</a></h2>"+"<div class='clearfix'></div><span><a data-partial=true href='/venue/"+t[r].url+"'>"+d.get(0).outerHTML+"</a></span>"+"<p>"+i+"</p>"+p+"</div></div>"}n+="</div>",$("#venueSearchResults").append(n),$("button.searchBookNow").off("click").on("click",function(e){e.preventDefault(),LoadPartial("/reserve/book-an-event-at-"+$(this).attr("data-target"))}),$("button.jumpToMap").off("click").on("click",function(e){e.preventDefault(),$("div.searchActive").removeClass("searchActive"),$(this).parents("div.panel-body").first().addClass("searchActive"),$("html, body").animate({scrollTop:$("#searchMap").offset().top});var t=null;for(r=0;r<markers.length;r++)markers[r].setIcon("https://mts.googleapis.com/vt/icon/name=icons/spotlight/spotlight-poi.png&scale=1"),markers[r].dataurl==$(this).attr("data-target")&&(t=r);t>=0&&(markers[t].setIcon("https://maps.google.com/mapfiles/ms/icons/green-dot.png"),map.setCenter(markers[t].getPosition()),markers[t].setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){markers[t].setAnimation(null)},2500))});var v=function(){if(typeof google!="undefined"&&typeof google.maps!="undefined"&&typeof google.maps.Map!="undefined"&&map!=null){clearInterval(m);for(var e=0;e<markers.length;e++)markers[e].setMap(null);markers=[];for(var n=0;n<t.length;n++){var r=new google.maps.Marker({animation:google.maps.Animation.DROP,map:map,position:new google.maps.LatLng(t[n].latitude,t[n].longitude),title:t[n].name,dataurl:t[n].url});google.maps.event.addListener(r,"click",function(e){return function(){for(var t=0;t<markers.length;t++)markers[t].setIcon("https://mts.googleapis.com/vt/icon/name=icons/spotlight/spotlight-poi.png&scale=1");e.setIcon("https://maps.google.com/mapfiles/ms/icons/green-dot.png"),$("div.searchActive").removeClass("searchActive");var n=$("div[data-url='"+SanitizeAttr(e.dataurl)+"']");n.addClass("searchActive"),$("html, body").animate({scrollTop:n.offset().top})}}(r)),markers.push(r),$(".jumpToMap[data-target='"+SanitizeAttr(r.dataurl)+"']").css({display:"inline-block"})}var i=new google.maps.LatLngBounds;for(n=0;n<markers.length;n++)i.extend(markers[n].getPosition());map.fitBounds(i),map.getZoom()>14&&map.setZoom(14)}},m=setInterval(v,200)}else $("#venueSearchResults").append("<div class='panel-body'><h2 style='text-align:center;margin:50px auto'>No venues found matching your search criteria</h2></div>")}else $("#venueSearchResults").append("<div class='panel-body'><div class='alert alert-danger'>"+e.result+"</div></div>")})}function GetVenueProfile(e){var t=new $.Deferred,n={method:"fGetVenueProfile",venueurl:e};return Post(n).then(function(e){if(e["result"]=="Invalid venue specified")LoadPartial("/404",null,!1);else if(e["result"]!="success")$("#bodyContent").empty().append("<div class='container text-center alert alert-danger' style='margin:20px auto'>"+e.result+"</div>");else{var n=e.data;if(n){n["visibility"]=="private"&&$("#bodyContent div.alert-info:contains('Public users')").length<1&&$("#venueProfile").before("<div class='alert alert-info container text-center' style='margin:20px auto'>Public users will be denied access to this page</div>"),$("title").empty().append((n.name+" - "+n.address.city).capitalize()+" | InviteBIG"),$("head meta[name='description']").attr("content",FormatShort(FormatDescription(n.description)).substring(0,150)),$(".findbtn a").attr("href","/reserve/book-an-event-at-"+n.url);var r="";n.pictures&&n.pictures.length>1&&(r=String(n.pictures[1].url)),r.indexOf("url(")!=0&&(r="url("+r+")"),$("#venueHeader").css({"background-image":r}),$("#venueBanner").empty().append(FormatDescription(n.banner)),$("#venueName").empty().append(n.name),$("#venueAddress").empty().append(n.address.address),$("#venueType").empty().append(n.type),$("#venueStyle").empty().append(n.style),$("#venueDescription").empty().append(FormatDescription(n.description)),$("#venueTimezone").val(n.tz),$("#venueCurrency").val(n.currency),$("#carousel-venue").empty(),$("#venueResources").empty(),$("#venueAddons").empty(),$("#menus").empty(),$("#venuePersonnel").empty(),$("#venueFeatures").empty(),$("#carousel-venue.slick-initialized").length>0&&typeof $("#carousel-venue").slick!="undefined"&&($("#carousel-venue").slick("unslick"),$("#carousel-venue-nav").slick("unslick"));for(var i=2;i<n.pictures.length;i++){var s=$("<div><img src='"+SanitizeAttr(n.pictures[i].url)+"'/></div>");s.find("img").attr("alt",n.pictures[i].caption),$("#carousel-venue").append(s.clone()),$("#carousel-venue-nav").append(s.clone())}$("#carousel-venue").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,fade:!0,dots:!1,infinite:!0,speed:500,asNavFor:"#carousel-venue-nav",responsive:[{breakpoint:564,settings:{arrows:!0,dots:!0}}]}),$("#carousel-venue-nav").slick({slidesToShow:5,slidesToScroll:1,arrows:!0,dots:!1,infinite:!0,speed:500,asNavFor:"#carousel-venue",focusOnSelect:!0,centerMode:!0}),n.functionality.menus||$("a[href='#menus']").parents("li").first().hide(),n.functionality.personnel||$("a[href='#personnel']").parents("li").first().hide();for(var i=0;i<n.resources.length;i++){var r=n.resources[i].photo?n.resources[i].photo:"";r.indexOf("/thumbnail/")<1&&(r=r.replace("/content/","/content/thumbnail/"));var o="<tr><td>";if(r.length>0){var s=$("<img class='profileTablePic' src='"+SanitizeAttr(r)+"'/>");s.attr("alt",n.resources[i].caption),o+=s.get(0).outerHTML}o+="<div class='media-body'><h5>"+n.resources[i].name+"</h5><p>"+FormatDescription(n.resources[i].description)+"</p></div></td>"+"<td><div class='timebold text-center'>"+n.resources[i].capacity+"</div></td>"+"<td><div class='timebold text-center'>"+FormatInterval(n.resources[i].min*60)+"</div></td>"+"<td><div class='timebold text-center'>"+FormatDollars(n.resources[i].price)+(n["resources"][i]["timeslots"]==1?"":"/hr")+(n["resources"][i]["pricePlus"]==1?"+":"")+"</div></td></tr>",$("#venueResources").append(o)}for(var i=0;i<n.addons.length;i++){var r=n.addons[i].photo?n.addons[i].photo:"";r.indexOf("/thumbnail/")<1&&(r=r.replace("/content/","/content/thumbnail/"));var o="<tr><td>";if(r.length>0){var s=$("<img class='profileTablePic' src='"+SanitizeAttr(r)+"'/>");s.attr("alt",n.addons[i].caption),o+=s.get(0).outerHTML}o+="<div class='media-body'><h5>"+n.addons[i].name+"</h5><p>"+FormatDescription(n.addons[i].description)+"</p></div></td>"+"<td><div class='timebold text-center'>"+(n["addons"][i]["price"]==0?"Free":FormatDollars(n.addons[i].price))+"</div></td></tr>",$("#venueAddons").append(o)}for(var i=0;i<n.menus.length;i++){var u="<legend class='menuHeader'><div class='menuName'>"+n.menus[i].name+"</div><div class='menuDescription'>"+FormatDescription(n.menus[i].description)+"</div></legend><table class='table table-striped table-condensed ptable'><thead><tr><th>Menu Item</th><th>Price</th><th>Order</th></tr></thead><tbody>";for(var a=0;a<n.menus[i].items.length;a++){u+="<tr class='reservationMenuItem' data-menuid='"+SanitizeAttr(n.menus[i].id)+"' data-id='"+SanitizeAttr(n.menus[i].items[a].id)+"' data-min=' "+n.menus[i].items[a].min+"' data-max=' "+n.menus[i].items[a].max+"'><td>";if(n.menus[i].items[a].photo.length>0){var s=$("<img class='profileTablePic' src='"+SanitizeAttr(n.menus[i].items[a].photo)+"'/>");s.attr("alt",n.menus[i].items[a].caption),u+=s.get(0).outerHTML}u+="<div class='media-body'><h5 class='reservationMenuItemTitle'>"+n.menus[i].items[a].name+"</h5><p>"+FormatDescription(n.menus[i].items[a].description)+"</p></div></td>"+"<td class='nowrap'><div class='timebold text-center reservationMenuItemPrice'>"+FormatDollars(n.menus[i].items[a].price)+"</div></td>"+"<td><input class='form-control reservationMenuItemQuantity' type='text' style='width:50px;display:inline-block' value='"+SanitizeAttr(n.menus[i].items[a].quantity?n.menus[i].items[a].quantity:0)+"'><div class='reservationMenuItemMinMax'>Min: "+n.menus[i].items[a].min+" Max: "+n.menus[i].items[a].max+"</div></td></tr>"}u+="</tbody></table>",$("#menus").append(u)}$(".menuHeader").first().css({"margin-top":"20px"});for(var i=0;i<n.personnel.length;i++){var o="<tr><td><div class='media-body'><h5>"+n.personnel[i].name+"</h5><p>"+FormatDescription(n.personnel[i].description)+"</p></div></td>"+"<td class='timebold text-center'>"+FormatDollars(n.personnel[i].rate)+"/hr</tr>";$("#venuePersonnel").append(o)}for(var i=0;i<n.features.length;i++)$("#venueFeatures").append(n.features[i]+"<br>");n.addons.length<1&&$("#venueAddons").append("<div class='media-body'><p>No addons available</p></div>"),n.menus.length<1&&$("#menus").append("<div class='media-body'><p>No menus available</p></div>"),n.personnel.length<1&&$("#venuePersonnel").append("<div class='media-body'><p>No personnel available</p></div>");var f='<!-- <script type="application/ld+json">{  "@context" : "http://schema.org",  "@type" : "LocalBusiness",  "@id" : "'+window.location.href+'",  "name" : "'+n.name+'",  "logo" : "'+n.pictures[0].url+'",  "image" : "'+n.pictures[0].url+'",  "address" : {    "@type" : "PostalAddress",    "streetAddress" : "'+n.address.street+'",    "addressLocality" : "'+n.address.city+'",    "addressRegion" : "'+n.address.state+'",    "addressCountry" : "'+n.address.country+'",    "postalCode" : "'+n.address.zip+'"  },  "url" : "'+window.location.href+'"}</script><script type="application/ld+json">{  "@context" : "http://schema.org",  "@type" : "EventVenue",  "openeningHours" : "",  "address" : {    "@type" : "PostalAddress",    "streetAddress" : "'+n.address.street+'",    "addressLocality" : "'+n.address.city+'",    "addressRegion" : "'+n.address.state+'",    "addressCountry" : "'+n.address.country+'",    "postalCode" : "'+n.address.zip+'"  },  "logo" : "'+n.pictures[0].url+'",  "image" : "'+n.pictures[0].url+'",  "name" : "'+n.name+'",  "url" : "'+window.location.href+'"}</script> -->';$("#bodyContent").append(f)}else $("#venueProfile").empty().append("<h4>Error: failed to load data for "+short_url+"</h4>")}t.resolve()}),t.promise()}$(".table-expandable").on("click",function(e){var t=$(e.target).parents("tr");t.hasClass("expandable-toggled")?t.removeClass("expandable-toggled"):t.addClass("expandable-toggled")});